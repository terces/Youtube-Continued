<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>Tube Cont'd.</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
	<!-- jquery google api -->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<!-- jqueryui google api -->
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
	<!-- youtube iframe api -->
	<script src="js/youtube.js"></script>
	<!-- 960 grid system start-->
	<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" />
	<link rel="stylesheet" type="text/css" media="all" href="css/text.css" />
	<link rel="stylesheet" type="text/css" media="all" href="css/960.css" />
	<!-- 960 grid system end-->
	<style>
		fieldset {
			border: black 2px dashed;
			padding: 10px 15px; 
			text-align: center;
			border-radius: 25px;
		}
		legend {
			text-align: center;
			font-family: "Bauhaus 93", fantasy;
			font-size: 4em;
		}
		#bt_loop {
			float: left;
		}
		#bt_next {
			float: right;
		}
		.ninja { 
			display: none;
		}
	</style>
	<script>
		$(document).ready( init);
		var ytloop = false;
		function init() {
			// search 
			$('#qform').submit( function() {
				start = false;
				$('#video_content').slideUp('slow');
				if( player) {
					player.destroy();
				}
				$.get( 'https://gdata.youtube.com/feeds/api/videos', 
					{ 
						q: $(':input[name=qs]').val(),
						v: 2,
						'max-results': 11,
						format: 5,
						alt: 'jsonc'
					}, function(d) {
						var r = Math.floor( Math.random() * 5);
						var u = d.data.items[r].id;
						// clean all candidate
						$('#relatedlist').html(''); 
						for( var i = 0; i < 11; i++) {
							if( i != r)
								$('#relatedlist').append( '<span class="candidate">' + d.data.items[i].id + '</span><br />');
						}
						realYouTubeIframeAPIDeploy( u); 
				}).complete( function() {
					$('#video_content').slideDown( 'slow');
				});
				return false;
			});

            // current video related
			$('#bt_loop').bind( 'click', function() {
				var s = $('#bt_loop').html();
				if( s == 'Loop') {
					ytloop = true;
					$('#bt_loop').html('Shuffle');
				}
				else { // s == Shuffle
					ytloop = false;
					$('#bt_loop').html('Loop');
				}
			});

			$('#bt_next').bind( 'click', function() {
				nextVideo();
			});
			// global setting up
			$('#bt_hide').bind( 'click', function () {
				$('#playlist').hide();
				var s = $('#bt_hide').html();
				if( s == 'Hide') {
					$('iframe').each(
					function( index, elem) {
						elem.setAttribute('height', '25');
					}
					);
					$('#bt_hide').html('Show');
				}
				else {
					$('iframe').each(
					function( index, elem) {
						elem.setAttribute('height', '225');
					}
					);
					$('#bt_hide').html('Hide');
				}
			});

			$('#bt_mode').bind( 'click', function() {
				$('#playlist').hide();
				$('#content').hide().html(
					'<input type="radio" name="box_mode" value="random" checked/> Random Chioce<br />' +
					'<input type="radio" name="box_mode" value="smart"/> Smart Chioce<br />'
				).fadeIn();
			});

			$('#bt_history').bind( 'click', function() {
				$('#content').hide().html('<p>History playlist</p>').fadeIn( 'slow', function() {
					$('#playlist').fadeIn();
				});
			});

			$('#bt_about').bind( 'click', function() {
				$('#playlist').hide();
				$('#content').hide().html('<p>Hi! I am terces</p>').fadeIn();
			});
		}

		function nextVideo() {
			var clist = $('.candidate');
			if( clist.length == 0) {
				alert( "No more candidate... search another?");
				if( player) 
					player.pauseVideo();
				return ;
			}
			if( start == false) {
				player.cueVideoById( { 
					videoId: clist[0].innerHTML, 
					suggestedQuality: 'large'
				});
			}
			else {
				player.loadVideoById( { 
					videoId: clist[0].innerHTML, 
					suggestedQuality: 'large'
				});
			}
			$('.candidate:first').remove();
			return ;
		}
	</script>
</head>

<body>

	<div class="container_12">
		<div class="grid_6 prefix_3 suffix_1">
			<div id="player_sec">
				<fieldset>
					<legend>Tube Cont.d</legend>
					<div id="search">
						<form id="qform" action="#" method="POST" >
							<input type="text" name="qs" />
							<input type="submit" class="ninja"/>
						</form>
					</div>
					<div id="video_content" class="ninja">
						<div id="ytframe">
						</div>
						<button id="bt_loop">Loop</button>
						<button id="bt_next">Next</button>
					</div>
				</fieldset>
			</div>
		</div>
		<div class="clear"></div>
		<div class="grid_2">
			<div id="content">
				<p>here would be something needs configure.</p>
			</div>
			<div id="playlist" class="ninja">
				<p>playlist</p>
			</div>
			<div id="relatedlist">
			</div>
		</div>
		<div class="grid_1">
			<div id="menu">
				<button id="bt_hide">Hide</button>
				<button id="bt_mode">Mode</button>
				<button id="bt_history">History</button>
				<button id="bt_about">About</button>
			</div>
		</div>
	</div>
</body>
</html>
